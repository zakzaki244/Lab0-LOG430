{% extends "base.html" %}
{% block content %}
<h2>Connexion</h2>
<form method="post">
  <label>Nom d’utilisateur :</label>
  <input name="username" required>
  <br>
  <label>Rôle :</label>
  <select name="role" id="role-select" required>
    <option value="">Sélectionnez un rôle</option>
    <option value="employe">Employé</option>
    <option value="responsable">Responsable</option>
    <option value="gestionnaire">Gestionnaire maison mère</option>
    <option value="logistique">Responsable logistique</option>
  </select>
  <br>
  <label id="magasin-label" style="display:none;">Magasin :</label>
  <select name="magasin_id" id="magasin-select" style="display:none;">
    <option value="">Sélectionnez un magasin</option>
    {% for store in magasins %}
      <option value="{{ store.id }}">{{ store.name }}</option>
    {% endfor %}
  </select>
  <br>
  <button type="submit">Se connecter</button>
</form>

<script>
  // Affiche/masque le menu magasin selon le rôle choisi
  document.addEventListener('DOMContentLoaded', function() {
    var roleSelect = document.getElementById('role-select');
    var magasinLabel = document.getElementById('magasin-label');
    var magasinSelect = document.getElementById('magasin-select');
    roleSelect.addEventListener('change', function() {
      if (this.value === "employe") {
        magasinLabel.style.display = 'inline';
        magasinSelect.style.display = 'inline';
      } else {
        magasinLabel.style.display = 'none';
        magasinSelect.style.display = 'none';
        magasinSelect.value = ""; // Reset sélection
      }
    });
  });
</script>

{% if message %}
  <div class="error">{{ message }}</div>
{% endif %}
{% endblock %}
