{% extends "base.html" %}
{% block content %}

<h2>Gérer les produits</h2>

<!-- FORMULAIRE AJOUT -->
<form method="POST" style="margin-bottom: 2em; border-bottom: 1px solid #ccc;">
    <input type="hidden" name="create" value="1">
    <b>Ajouter un produit :</b><br>
    <input name="name" placeholder="Nom" required>
    <input name="category" placeholder="Catégorie" required>
    <input name="price" placeholder="Prix" type="number" step="0.01" required>
    <input name="stock" placeholder="Stock" type="number" required>
    <select name="store_id">
      {% for mag in magasins %}
        <option value="{{ mag.id }}">{{ mag.name }}</option>
      {% endfor %}
    </select>
    <button type="submit">Créer</button>
</form>

<!-- LISTE PRODUITS & EDIT INLINE -->
<table border="1" cellpadding="5" style="background:#fff;">
    <tr>
        <th>ID</th>
        <th>Nom</th>
        <th>Catégorie</th>
        <th>Prix</th>
        <th>Stock</th>
        <th>Magasin</th>
        <th>Action</th>
    </tr>
    {% for prod in produits %}
    <tr>
      <form method="POST" style="display:contents">
        <input type="hidden" name="edit" value="1">
        <input type="hidden" name="prod_id" value="{{ prod.id }}">
        <td>{{ prod.id }}</td>
        <td><input name="name" value="{{ prod.name }}" required></td>
        <td><input name="category" value="{{ prod.category }}" required></td>
        <td><input name="price" type="number" step="0.01" value="{{ prod.price }}" required style="width:5em;"></td>
        <td><input name="stock" type="number" value="{{ prod.stock }}" required style="width:5em;"></td>
        <td>
          <select name="store_id">
            {% for mag in magasins %}
                <option value="{{ mag.id }}" {% if prod.store_id == mag.id %}selected{% endif %}>{{ mag.name }}</option>
            {% endfor %}
          </select>
        </td>
        <td>
            <button type="submit">Enregistrer</button>
      </form>
      <!-- Bouton supprimer (demande confirmation JS) -->
      <form method="POST" style="display:inline" onsubmit="return confirm('Confirmer la suppression ?');">
        <input type="hidden" name="delete" value="1">
        <input type="hidden" name="prod_id" value="{{ prod.id }}">
        <button type="submit" style="color:red;">Supprimer</button>
      </form>
        </td>
    </tr>
    {% endfor %}
</table>

{% endblock %}
